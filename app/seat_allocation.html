<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>CSET Seat Booking - Home</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <!-- <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon"> -->

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Poppins:300,400,500,700" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <link rel="stylesheet" href="plugins/flexible-seating-layout/src/bin/seatLayout/seatLayout.css">
  

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <style>
    #nav-tabContent, .tab-pane:focus
        {
            outline: 0;
        }
  </style>
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center ">
    <div class="container d-flex justify-content-between align-items-center">

      <div id="logo">
        <h1 style="color:white;">CSET Seat Booking</h1>
        <!-- Uncomment below if you prefer to use a text logo -->
        <!--<h1><a href="index.html">Regna</a></h1>-->
      </div>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto" href="seat_booking.html">Seat Booking</a></li>
          <li><a class="nav-link scrollto active" href="seat_allocation.html">Seat Allocation</a></li>
          <li><a class="nav-link scrollto" href="orgnization_tree.html">Orgnization Tree</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->
    </div>
  </header><!-- End Header -->

  <main id="main">

  
    <div class="container example" style="margin-top: 125px;">
    <!-- <section class="inner-page pt-4" > -->
      <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <button class="nav-link active" id="floor1-nav" data-bs-toggle="tab" data-bs-target="#floor1" type="button" role="tab" aria-controls="floor1" aria-selected="true">Floor 1</button>
          <button class="nav-link" id="floor2-nav" data-bs-toggle="tab" data-bs-target="#floor2" type="button" role="tab" aria-controls="floor2" aria-selected="false">Floor 2</button>
          <button class="nav-link" id="floor3-nav" data-bs-toggle="tab" data-bs-target="#floor3" type="button" role="tab" aria-controls="floor3" aria-selected="false">Floor 3</button>
          <button class="nav-link" id="floor4-nav" data-bs-toggle="tab" data-bs-target="#floor4" type="button" role="tab" aria-controls="floor4" aria-selected="false">Floor 4</button>
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="floor1" role="tabpanel" aria-labelledby="floor1-nav" tabindex="0">
          <div id="seat_layout_floor1"></div>
        </div>
        <div class="tab-pane fade" id="floor2" role="tabpanel" aria-labelledby="floor2-nav" tabindex="0">
          <div id="seat_layout_floor2"></div>
        </div>
        <div class="tab-pane fade" id="floor3" role="tabpanel" aria-labelledby="floor3-nav" tabindex="0">
          <div id="seat_layout_floor3"></div>  
        </div>
        <div class="tab-pane fade" id="floor4" role="tabpanel" aria-labelledby="floor4-nav" tabindex="0">
          <div id="seat_layout_floor4"></div>
        </div>
      </div>
      
    
  </div>

  </main><!-- End #main -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <!-- Vendor JS Files -->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>

  <script src="plugins/flexible-seating-layout/src/bin/seatLayout/seatLayout.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

  <script>
  $(document).ready(function () {
    // seatData = ''
    // $.getJSON('plugins/flexible-seating-layout/src/app/data/layoutData.json', function(data) {         
    //   seatData = data;
    //   loadGrid(seatData);
    // });

    $.ajax({
      url: "http://localhost:5000/get_seat_allocation/abc",
      success: function(seatData){
        // var data = [JSON.parse(seatData[0])]
        
        loadGrid('seat_layout_floor1', seatData['L1']);
        loadGrid('seat_layout_floor2', seatData['L2']);
        loadGrid('seat_layout_floor3', seatData['L3']);
        loadGrid('seat_layout_floor4', seatData['L4']);
      }});
  });

  function loadGrid(id, seatData) {
        $('#'+id).seatLayout({
            data: seatData,
            showActionButtons:false,
            classes : {
                doneBtn : '',
                cancelBtn : '',
                row:'',
                area:'',
                screen:'hide-screen',
                seat:''
            },
            numberOfSeat: 0,
            callOnSeatRender: function (Obj) {
                //modify seat object if require and return it;
                return Obj;
            },
            callOnSeatSelect: function (_event, _data, _selected, _element) {
              // alert('hi')
                // thisVal.attr("data-content", data);
                console.log(_event);
                console.log(_data);
                console.log(_selected);
                // $('li data-seatdefination=['+_data+'] i').attr("title", 'Department: '+_data.department);
                // // _selected.attr("data-content", 'Department: '+_data.department+'</br>Manager_OE_Code: '+_data.Manager_OE_Code);
                // $('[data-toggle="popover"]').popover();  
            },
            selectionDone: function (_array) {
                console.log(_array);
            },
            cancel: function () {
                return false;
            }
        });

        $('.seat-selection').attr('style', 'width:1200px');
        $('#'+id+' ul li.seat-row-seat.seat-yes').html('<i data-toggle="popover" class="fa fa-desktop" aria-hidden="true"></i>');
        $('#'+id+' ul li.can-select').html('<i data-toggle="popover" class="fa fa-desktop" aria-hidden="true"></i>');
        
        // $('#'+id+' ul li').each(function(key, val){
          
        //   data = $(val).attr('data-seatdefination')
        //   data = JSON.parse(data)
        //   console.log(data)
        //   // if(data!==undefined){
        //   //   console.log(data)
        //   //   console.log(data.department)
        //   //   $(val).find('i').attr("title", 'Department: '+data.department);
        //   // }
        // })
        
        $('[data-toggle="popover"]').popover();  

    }


  </script>

</body>

</html>